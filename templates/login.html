{% extends 'base.html' %}

{% block content %}
<div class="auth-layout">
    <div class="auth-box">
        <div class="auth-header">
            <img src="https://api.dicebear.com/7.x/identicon/svg?seed=GridSystem" class="auth-logo" alt="Logo">
            <h2 class="auth-title">GRID // SYSTEM</h2>
            <p class="auth-subtitle">
                {% if mode == 'register' %}Inicializaci√≥n de Credenciales{% else %}Acceso Seguro Requerido{% endif %}
            </p>
        </div>

        {% with messages = get_flashed_messages(with_categories=true) %}
            {% if messages %}
                <div style="margin-bottom: 20px;">
                {% for category, message in messages %}
                    <div style="padding: 10px; background: rgba(255,255,255,0.05); border: 1px solid var(--border-light); border-radius: 4px; color: {% if category=='error' %}#ef4444{% else %}#10b981{% endif %}; font-size: 0.9rem;">
                        {{ message }}
                    </div>
                {% endfor %}
                </div>
            {% endif %}
        {% endwith %}

        <form action="{{ request.path }}" method="POST" class="auth-form">
            {% if mode == 'admin' %}
                <div class="form-group">
                    <label>LLAVE MAESTRA</label>
                    <input type="password" name="password" required autofocus>
                </div>
                <input type="hidden" name="username" value="admin">
            {% else %}
                <div class="form-group">
                    <label>IDENTIFICADOR</label>
                    <input type="text" name="username" required autocomplete="off" autofocus>
                </div>

                {% if mode == 'register' %}
                <div class="form-group">
                    <label>CANAL DE CONTACTO (EMAIL)</label>
                    <input type="email" name="email">
                </div>
                {% endif %}

                <div class="form-group">
                    <label>CLAVE DE ACCESO</label>
                    <input type="password" name="password" required>
                </div>
            {% endif %}

            <button type="submit" class="btn btn-primary" style="width: 100%; margin-top: 10px; padding: 12px;">
                {% if mode == 'register' %}REGISTRAR USUARIO{% else %}AUTENTICAR{% endif %}
            </button>
        </form>

        <div class="auth-footer">
            {% if mode == 'login' %}
                <a href="{{ url_for('auth.register') }}">Solicitar Acceso</a>
            {% elif mode == 'register' %}
                <a href="{{ url_for('auth.login') }}">Volver al Login</a>
            {% else %}
                <a href="{{ url_for('main.index') }}">Cancelar</a>
            {% endif %}
        </div>
    </div>
</div>
{% endblock %}