{% extends 'base.html' %}

{% block content %}
<div class="login-wrapper">
    <div class="login-card">
        <div class="login-header">
            <img src="https://api.dicebear.com/7.x/identicon/svg?seed=Grid" alt="Logo" class="login-logo">
            {% if mode == 'register' %}
                <h2>Crear Cuenta</h2>
                <p>Ãšnete a la mejor comunidad de chat</p>
            {% elif mode == 'admin' %}
                <h2>Admin Access</h2>
                <p>Zona restringida</p>
            {% else %}
                <h2>Bienvenido</h2>
                <p>Ingresa tus credenciales</p>
            {% endif %}
        </div>

        {% with messages = get_flashed_messages(with_categories=true) %}
            {% if messages %}
                <div class="flash-messages">
                {% for category, message in messages %}
                    <div class="flash-msg {{ category }}">{{ message }}</div>
                {% endfor %}
                </div>
            {% endif %}
        {% endwith %}

        <form action="{{ request.path }}" method="POST" class="login-form">
            
            {% if mode == 'admin' %}
                <div class="input-group">
                    <span class="input-icon">ðŸ”’</span>
                    <input type="password" name="password" required placeholder="ContraseÃ±a Maestra">
                </div>
                <input type="hidden" name="username" value="admin"> <!-- Dummy for compatibility if needed -->
            {% else %}
                <div class="input-group">
                    <span class="input-icon">ðŸ‘¤</span>
                    <input type="text" name="username" required placeholder="Nombre de usuario" autocomplete="off">
                </div>

                {% if mode == 'register' %}
                <div class="input-group">
                    <span class="input-icon">ðŸ“§</span>
                    <input type="email" name="email" placeholder="Email (opcional)">
                </div>
                {% endif %}

                <div class="input-group">
                    <span class="input-icon">ðŸ”‘</span>
                    <input type="password" name="password" required placeholder="ContraseÃ±a">
                </div>
            {% endif %}

            <button type="submit" class="btn-login">
                {% if mode == 'register' %}REGISTRARSE{% else %}INGRESAR{% endif %}
            </button>
        </form>

        <div class="login-footer">
            {% if mode == 'login' %}
                <p>Â¿No tienes cuenta? <a href="{{ url_for('register') }}">Crear cuenta</a></p>
            {% elif mode == 'register' %}
                <p>Â¿Ya tienes cuenta? <a href="{{ url_for('login') }}">Iniciar SesiÃ³n</a></p>
            {% else %}
                <a href="{{ url_for('index') }}">Volver al inicio</a>
            {% endif %}
        </div>
    </div>
</div>
{% endblock %}